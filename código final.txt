#include <stdio.h>
#include <string.h>

typedef struct {
    char nome[50];
    int matricula;
    float notas[3];
    float media;
} Aluno;

void cadastroAlunos(Aluno *alunos, int *qtd){
    
    printf("Quantos alunos vamos cadastrar? (max 5) ");
    scanf("%d", qtd);

    while(*qtd < 1 || *qtd > 5){
        printf("Valor invalido. Digite entre 1 e 5: ");
        scanf("%d", qtd);
    }

    for(int i=0; i < *qtd; i++){
        printf("\n--- Aluno %d ---\n", i+1);

        printf("Nome: ");
        scanf(" %49[^\n]", alunos[i].nome);

        printf("Matricula: ");
        scanf("%d",&alunos[i].matricula);

        for(int j=0; j<3; j++){
            printf("Nota %d: ", j+1);
            scanf("%f",&alunos[i].notas[j]);
        }

        alunos[i].media = 0; 
    }
}

void calcularMedias(Aluno *alunos, int qtd){
    for(int i=0; i<qtd; i++){
        float soma = 0;

        for(int j=0; j<3; j++){
            soma += alunos[i].notas[j];
        }

        alunos[i].media = soma / 3.0;
    }
}

float mediaTurma(Aluno *alunos, int qtd){
    float soma = 0;
    for(int i=0; i<qtd; i++){
        soma += alunos[i].media;
    }
    return soma / qtd;
}

void exibirRelatorio(Aluno *alunos, int qtd)
{
    float maior = alunos[0].media;
    float menor = alunos[0].media;

    char nomeMaior[50];
    char nomeMenor[50];

    strcpy(nomeMaior, alunos[0].nome);
    strcpy(nomeMenor, alunos[0].nome);

    float somaTurma = 0;

    char aprovadosNomes[5][50];
    int aprovados = 0;

    for (int i = 0; i < qtd; i++) {

        if (alunos[i].media > maior) {
            maior = alunos[i].media;
            strcpy(nomeMaior, alunos[i].nome);
        }

        if (alunos[i].media < menor) {
            menor = alunos[i].media;
            strcpy(nomeMenor, alunos[i].nome);
        }

        somaTurma += alunos[i].media;

        if (alunos[i].media >= 7.0) {
            strcpy(aprovadosNomes[aprovados], alunos[i].nome);
            aprovados++;
        }
    }

    float mediaFinal = somaTurma / qtd;

    printf("\n----- RELATORIO FINAL -----\n");
    printf("Maior media: %.2f (%s)\n", maior, nomeMaior);
    printf("Menor media: %.2f (%s)\n", menor, nomeMenor);
    printf("Media da turma: %.2f\n", mediaFinal);
    printf("Aprovados: %d\n", aprovados);

    if (aprovados > 0) {
        printf("Nomes dos aprovados:\n");
        for (int i = 0; i < aprovados; i++) {
            printf("- %s\n", aprovadosNomes[i]);
        }
    }
}

int main()
{
    Aluno turma[5];
    int qtd;

    cadastroAlunos(turma, &qtd);
    calcularMedias(turma, qtd);

    printf("\nCadastro concluido! Foram cadastrados %d alunos.\n", qtd);

    for (int i = 0; i < qtd; i++) {
        printf("Aluno %d: %s - Matricula: %d - Media: %.2f\n",
               i+1,
               turma[i].nome,
               turma[i].matricula,
               turma[i].media);
    }

    exibirRelatorio(turma, qtd);

    return 0;
}
